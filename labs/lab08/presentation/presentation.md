---
lang: ru-RU
title: Администрирование системных подсистем
subtitle: Настройка и проверка работы SMTP-сервера Postfix
author:
  - Сейдалиев Тагиетдин Ровшенович
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 30 ноября 2025
toc: false
slide_level: 2
aspectratio: 169
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цель работы

## Основная цель

Приобрести навыки установки, конфигурирования и диагностики SMTP-сервера Postfix и настройки DNS для доставки почты.

# Подготовка и запуск Postfix

## Разрешение SMTP в firewalld

На сервере разрешается работа SMTP-службы в межсетевом экране.

![Разрешение службы SMTP в firewalld](Screenshot_2.png){ width=85% }

## Настройка myorigin и домена

В Postfix настраиваются параметры myorigin и mydomain для использования собственного домена.

![Настройка myorigin и проверка Postfix](Screenshot_3.png){ width=85% }

# Проверка локальной доставки на сервере

## Отправка и мониторинг

Для проверки локальной доставки отправляется тестовое письмо и анализируется журнал maillog.

## Локальная доставка в журнале

Журнал maillog показывает успешную доставку локального письма в почтовый ящик.

![Мониторинг доставки письма на сервере](Screenshot_4.png){ width=85% }

## Содержимое почтового ящика

В каталоге `/var/spool/mail` видно сохранённое локальное письмо пользователя.

![Содержимое почтового ящика на сервере](Screenshot_5.png){ width=85% }

# Настройка и проверка клиента

## Установка Postfix на клиенте

На клиентской машине выполняется установка и запуск Postfix с использованием IPv4.

![Установка и запуск Postfix на клиенте](Screenshot_6.png){ width=85% }

## Сетевые параметры сервера

На сервере настраиваются inet_interfaces и mynetworks для приёма почты от клиента.

![Настройка сетевых параметров и перезапуск Postfix на сервере](Screenshot_7.png){ width=85% }

## Лог доставки письма от клиента

Журнал подтверждает, что письмо от клиента успешно принято и доставлено.

![Журнал доставки письма от клиента](Screenshot_8.png){ width=85% }

## Почтовый ящик после письма клиента

В почтовом ящике сервера видно доставленное письмо, отправленное с клиентской машины.

![Содержимое доставленного письма от клиента](Screenshot_9.png){ width=85% }

# Настройка для домена

## Ошибка из-за отсутствия маршрута

Попытка отправки письма на доменный адрес завершается bounce из-за ошибки подключения по SMTP.

![Журнал доставки с ошибкой](Screenshot_10.png){ width=85% }

## Сообщение в очереди

Неудачно доставленное письмо остаётся в очереди Postfix на клиенте.

![Очередь сообщений на клиенте](Screenshot_11.png){ width=85% }

## Прямая DNS-зона

В прямой DNS-зоне добавляется MX-запись и A-записи для почтового сервера и узлов.

![Прямая DNS-зона](Screenshot_12.png){ width=80% }

## Обратная DNS-зона

В обратной DNS-зоне настраиваются PTR-записи для всех хостов, включая почтовый сервер.

![Обратная DNS-зона](Screenshot_13.png){ width=80% }

## Обновление mydestination и служб

В Postfix домен добавляется в mydestination, восстанавливаются SELinux-контексты и перезапускаются службы.

![Настройка mydestination и восстановление контекстов](Screenshot_14.png){ width=85% }

## Лог успешной доставки доменной почты

После исправлений журнал фиксирует успешную доставку письма на доменный адрес.

![Журнал успешной доставки](Screenshot_15.png){ width=85% }

## Почтовый ящик после исправления

В почтовом ящике пользователя появляется письмо, доставленное на доменный адрес.

![Полученное письмо после исправления конфигурации](Screenshot_16.png){ width=85% }

# Итоги работы

## Основные результаты

- настроен почтовый сервер Postfix на сервере и клиенте;  
- проверена локальная и удалённая доставка писем;  
- проанализированы журналы maillog и очередь postqueue;  
- настроены прямые и обратные DNS-зоны с A-, PTR- и MX-записями;  
- обновлены параметры Postfix для доменной доставки;  
- выполнена автоматизация конфигурации через провижион-скрипты.
