---
lang: ru-RU
title: Администрирование системных подсистем
subtitle: Настройка безопасного удалённого доступа по SSH
author:
  - Сейдалиев Тагиетдин Ровшенович
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 05 декабря 2025
toc: false
slide_level: 2
aspectratio: 169
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цель работы

## Основная цель

Приобрести практические навыки настройки защищённого SSH-доступа,  
включая работу с пользователями, ключевой аутентификацией, портами и туннелями.

# Запрет доступа root

## Попытка входа root

- Система запрашивает пароль, но не допускает root  
- В журнале фиксируются отказанные попытки входа  
- В конфигурации установлен `PermitRootLogin no`

![Попытка входа root](Screenshot_1.png){width=80%}

## Конфигурация

![Конфигурация sshd root](Screenshot_2.png){width=70%}

После перезапуска службы результат остаётся тем же: вход root заблокирован.

# Ограничение пользователей SSH

## Вход пользователя trseidaliev

Успешное подключение:

![Успешный вход](Screenshot_4.png){width=80%}

## AllowUsers

Разрешён только `vagrant`:

![AllowUsers vagrant](Screenshot_5.png){width=70%}

Попытка входа trseidaliev завершается отказом:

![Отказ доступа](Screenshot_6.png){width=80%}

## Добавление второго пользователя

После добавления trseidaliev:

![AllowUsers 2](Screenshot_7.png){width=70%}

Подключение снова доступно:

![Успешный вход после изменения](Screenshot_8.png){width=80%}

# Настройка нескольких портов SSH

## Добавление порта 2022

![Добавление порта](Screenshot_9.png){width=70%}

## Ошибка SELinux

![Permission denied port 2022](Screenshot_10.png){width=80%}

SELinux блокирует нестандартный порт до назначения корректной метки.

## Исправление и запуск

После настройки SELinux и firewall — оба порта работают:

![Порты 22 и 2022](Screenshot_11.png){width=80%}

## Проверка соединений

Через порт 22 и 2022:

![Подключение через 2022](Screenshot_12.png){width=80%}

# Подключение по ключам

## Включение PubkeyAuthentication

![PubkeyAuth](Screenshot_13.png){width=70%}

## Установка ключей и подключение

Сгенерированы ключи, публичный импортирован на сервер.  
Подключение выполняется без пароля:

![Успешное подключение по ключу](Screenshot_14.png){width=80%}

# SSH-туннели и перенаправление портов

## Создание туннеля

До туннеля — список соединений пуст.

После создания туннеля:

![Список TCP](Screenshot_15.png){width=80%}

## Проверка

Переход на `localhost:8080` открывает страницу сервера:

![Прокси веб-сервера](Screenshot_16.png){width=80%}

# Удалённый запуск приложений

## Консольные команды

hostname:

![hostname](Screenshot_17.png){width=80%}

## Консольные команды

Maildir:

![Maildir](Screenshot_18.png){width=80%}

# X11-переадресация

## Включение X11Forwarding

![X11Forwarding](Screenshot_19.png){width=70%}

## Ошибка запуска GUI

![Ошибка X11](Screenshot_20.png){width=80%}

Причина: на клиенте отсутствует активный X-сервер.

# Автоматизация провижининга

## Создание каталога и скрипта

В каталог `/vagrant/provision/server/ssh/etc/ssh` помещён рабочий sshd_config.  
Файл `ssh.sh` автоматизирует все ручные действия.

![ssh.sh](Screenshot_21.png){width=80%}

# Итоги

## Основные результаты

- Ограничен список разрешённых пользователей  
- Включена работа SSH на портах 22 и 2022  
- Реализована аутентификация по ключам  
- Созданы SSH-туннели и проверена их работа  
- Выполнен удалённый запуск консольных приложений  

